<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Interface toggle</title>
  <link rel="stylesheet" type="text/css" href="switch.css">
  <script src="ifacectl.js"></script>
</head>
<body>
  <div class="onoffswitch">
    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="ifacetoggle" onclick="toggle(this);">
    <label class="onoffswitch-label" for="myonoffswitch">
      <span class="onoffswitch-inner"></span>
      <span class="onoffswitch-switch"></span>
    </label>
  </div>
</body>
<script>

function toggle(status){
  console.log("changing interface state");
  if (status.checked === true) {
    iface.set("int1", "up", function(err, results){
      if (err) {
        console.log("got error");
        console.log(err);
      } else {
        console.log("got results");
        console.log(results);
        if (results.state === "up") {
          document.getElementById("ifacetoggle").checked = true;
        } else if (results.state === "down") {
          document.getElementById("ifacetoggle").checked = false;
        }
      }
    })
  } else if (status.checked === false) {
    iface.set("int1", "down", function(err, results){
      if (err) {
        console.log("got error");
        console.log(err);
      } else {
        console.log("got results");
        console.log(results);
        if (results.state === "up") {
          document.getElementById("ifacetoggle").checked = true;
        } else if (results.state === "down") {
          document.getElementById("ifacetoggle").checked = false;
        }
      }
    })
  }
}

// get initial interface state, and set state of iface toggle switch
iface.get("int1", function(err, results){
  if (err) {
    console.log("got error");
    console.log(err);
  } else {
    console.log("got results");
    console.log(results);
    /*
    if (results.state == "up") {
      document.getElementById("ifacetoggle").checked = true;
    } else if (results.state == "down") {
      document.getElementById("ifacetoggle").checked = false;
    }
    */
  }
})

</script>
</html>
